"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var r=[],a=!0,o=!1,n=void 0;try{for(var l,s=e[Symbol.iterator]();!(a=(l=s.next()).done)&&(r.push(l.value),!t||r.length!==t);a=!0);}catch(e){o=!0,n=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw n}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_templates=require("../../../helpers/templates.js"),_templates2=_interopRequireDefault(_templates),_notifier=require("../../../helpers/notifier.js"),_notifier2=_interopRequireDefault(_notifier),_blogsData=require("../data/blogs-data.js"),_blogsData2=_interopRequireDefault(_blogsData);exports.default={home:function(e){var t=e.params.page,r=e.params.size;Promise.all([_blogsData2.default.all(t,r),_templates2.default.load("home")]).then(function(t){var r=_slicedToArray(t,2),a=r[0],o=r[1],n=JSON.parse(JSON.stringify(a.result.blogs)),l=JSON.parse(JSON.stringify(a.result.pagination));e.$element().html(o({blogs:n,pagination:l}))})},allByCategoryName:function(e){var t=e.params.subcategory,r=e.params.category;Promise.all([_blogsData2.default.byCategoryName(t,r),_templates2.default.load("list-blogs-category")]).then(function(t){var r=_slicedToArray(t,2),a=r[0],o=r[1];e.$element().html(o({blogs:a}))})},byId:function(e){var t=e.params.id;Promise.all([_blogsData2.default.byId(t),_templates2.default.load("single-blog")]).then(function(r){var a=_slicedToArray(r,2),o=a[0],n=a[1],l=localStorage.getItem("user"),s=JSON.parse(l);e.$element().html(n(o.blog)),$("#leave-reply-submit").on("click",function(e){e.preventDefault();var r={content:$("#leave-reply-text").val(),postedBy:s.username||"Stranger"};_blogsData2.default.addComment(t,r),location.reload(!0)})})},post:function(e){_templates2.default.load("blog-create").then(function(t){e.$element().html(t()),$("#btn-create-post").on("click",function(){var t,r=localStorage.getItem("user"),a=JSON.parse(r),o=$("#create-tags").val(),n=o.split(" ").filter(function(e){return e}),l={title:$("#title").val(),category:$("#category").val(),subcategory:$("#subcategory").val(),image:$("#image").val(),article:$("#article").val(),tags:[],postedBy:a.username};(t=l.tags).push.apply(t,_toConsumableArray(n)),_blogsData2.default.create(l).then(function(){_notifier2.default.send("Post created!"),e.redirect("#/home")})})})},searchCategory:function(e){var t=e.params.category;Promise.all([_blogsData2.default.allCategoryName(t),_templates2.default.load("list-blogs-category")]).then(function(t){var r=_slicedToArray(t,2),a=r[0],o=r[1];console.log(a),e.$element().html(o({blogs:a}))})},searchSubCategory:function(e){var t=e.params.subcategory;Promise.all([_blogsData2.default.allSubcategoryName(t),_templates2.default.load("list-blogs-category")]).then(function(t){var r=_slicedToArray(t,2),a=r[0],o=r[1];console.log(a),e.$element().html(o({blogs:a}))})}},Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery");var _userData=require("../data/user-data.js"),_userData2=_interopRequireDefault(_userData),_templates=require("./../../../helpers/templates.js"),_templates2=_interopRequireDefault(_templates),_notifier=require("./../../../helpers/notifier.js"),_notifier2=_interopRequireDefault(_notifier);exports.default={register:function(e){_templates2.default.load("register").then(function(t){e.$element().html(t()),$("#btn-reg").on("click",function(){var t=$("#reg-username").val();console.log(t);var r=$("#reg-password").val(),a=$("#reg-email").val();(t.length<6||r.length<6)&&(_notifier2.default.send("Invalid username or password"),_notifier2.default.explain("Password and username must be longer than 6 symbols","Check your input","warning"));var o={username:t,password:r,email:a};_userData2.default.register(o).then(function(t){console.log(t),$("#register").hide(),$("#logout").show(),_notifier2.default.send(t.username+" registered!"),e.redirect("#/home")})})})},login:function(e){_templates2.default.load("login").then(function(t){e.$element().html(t()),$("#btn-login").on("click",function(){var t={username:$("#login-username").val(),password:$("#login-password").val()};_userData2.default.login(t).then(function(t){$("#login").hide(),$("#register").hide(),$("#logout").show(),localStorage.setItem("user",JSON.stringify(t)),_notifier2.default.send(t.username+" logged in!"),_notifier2.default.explain("Welcome!","Now you can leave comments!","ok"),e.redirect("#/home")})})})}},Object.defineProperty(exports,"__esModule",{value:!0});var _requester=require("../../../helpers/requester.js"),_requester2=_interopRequireDefault(_requester);exports.default={all:function(e,t){return _requester2.default.get("/blogs?page="+e+"&size="+t)},byId:function(e){return _requester2.default.get("/blogs/"+e).then(function(e){return e})},create:function(e){return _requester2.default.post("/blogs",e)},addComment:function(e,t){return _requester2.default.post("/blogs/"+e,t)},byCategoryName:function(e,t){return _requester2.default.get("/blogs/"+e+"/"+t).then(function(e){return e})},allCategoryName:function(e){return _requester2.default.get("/search/category/"+e).then(function(e){return e})},allSubcategoryName:function(e){return _requester2.default.get("/search/subcategory/"+e).then(function(e){return e})}},Object.defineProperty(exports,"__esModule",{value:!0});var _requester=require("../../../helpers/requester.js"),_requester2=_interopRequireDefault(_requester);exports.default={register:function(e){return _requester2.default.post("/register",e).then(function(e){return e.resUser})},login:function(e){return _requester2.default.post("/login",e).then(function(e){return e.user})},logout:function(){return _requester2.default.post("/logout").then(function(e){console.log(e)})}},require("jquery"),$(document).ready(function(){$(".loader").fadeOut("slow")}),Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery"),require("amaran"),exports.default={send:function(e){$.amaran({message:e,position:"top right",delay:5e3})},explain:function(e,t,r){$.amaran({theme:"awesome "+r||"",content:{title:e||"",message:t,info:""},position:"top right",delay:5e3})}},Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery"),exports.default={get:function(e,t){return new Promise(function(r,a){$.ajax({url:e,method:"GET",contentType:"application/json",headers:t,success:function(e){r(e)},error:function(e){a(e)}})})},post:function(e,t,r){return new Promise(function(a,o){$.ajax({url:e,method:"POST",headers:r,contentType:"application/json",data:JSON.stringify(t),success:function(e){a(e)},error:function(e){o(e)}})})},put:function(e,t,r){return new Promise(function(a,o){$.ajax({url:e,method:"PUT",headers:r,contentType:"application/json",data:JSON.stringify(t),success:function(e){a(e)},error:function(e){o(e)}})})},del:function(e,t,r){return new Promise(function(a,o){$.ajax({url:e,method:"DELETE",headers:r,contentType:"application/json",data:JSON.stringify(t),success:function(e){a(e)},error:function(e){o(e)}})})}},Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={searchparamsCategory:function(e){return"DC"===e||"dc"===e||"Marvel"===e||"marvel"===e||"Image"===e||"image"===e||"Darkhorse"===e||"darkhorse"===e},capitalizeFirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},capitalizeFirstTwo:function(e){return e.toUpperCase()}},Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery");var handlebars=window.handlebars||window.Handlebars;exports.default={load:function(e){var t="../app/js/templates/"+e+".handlebars";return new Promise(function(e,r){$.ajax({url:t,success:function(t){e(handlebars.compile(t))},error:function(e){r(e)}})})}};var _blogsController=require("./app/js/controllers/blogsController.js"),_blogsController2=_interopRequireDefault(_blogsController),_usersController=require("./app/js/controllers/usersController.js"),_usersController2=_interopRequireDefault(_usersController),_searchParamsVerifier=require("./helpers/search-params-verifier.js"),_searchParamsVerifier2=_interopRequireDefault(_searchParamsVerifier),_notifier=require("./helpers/notifier.js"),_notifier2=_interopRequireDefault(_notifier);!function(){var e=Sammy("#content",function(){this.get("#/",function(){this.redirect("#/home")}),this.get("#/home",_blogsController2.default.home),this.get("#/blog/:id",_blogsController2.default.byId),this.get("#/blogs/:subcategory/:category",_blogsController2.default.allByCategoryName),this.get("#/search/category/:category",_blogsController2.default.searchCategory),this.get("#/search/subcategory/:subcategory",_blogsController2.default.searchSubCategory),this.get("#/blogs/add",_blogsController2.default.post),this.get("#/register",_usersController2.default.register),this.get("#/login",_usersController2.default.login)});$(function(){e.run("#/"),$(document).ready(function(){$("#create-post").hide(),$(document).on("click",".login-click",function(){$("#create-post").show()})}),$(document).on("mouseout",".dropdown-item",function(){$(".dropdown-item").css("background-color","#222222")}),$(document).on("click",".register-click",function(){$("#create-post").show(),$("#login").hide()}),$(document).on("click",".home-search-button",function(){var e=$("#search-input").val(),t=void 0;_searchParamsVerifier2.default.searchparamsCategory(e)?("dc"===e&&$(location).attr("href","#/search/category/"+_searchParamsVerifier2.default.capitalizeFirstTwo(e)),$(location).attr("href","#/search/category/"+_searchParamsVerifier2.default.capitalizeFirst(e))):e.includes("Comics")||e.includes("comic")||e.includes("comics")?($("#search-input").val("Comics"),t=$("#search-input").val(),$(location).attr("href","#/search/subcategory/"+t)):e.includes("Action")||e.includes("action")||e.includes("Figures")||e.includes("figures")?($("#search-input").val("Action Figures"),t=$("#search-input").val(),$(location).attr("href","#/search/subcategory/"+t)):e.includes("Graphic")||e.includes("graphic")||e.includes("Novels")||e.includes("novels")||e.includes("novel")?($("#search-input").val("Graphic Novels"),t=$("#search-input").val(),$(location).attr("href","#/search/subcategory/"+t)):(_notifier2.default.send("Invalid search request"),_notifier2.default.explain("Search params must be valid category/subcategory","warning")),$("#search-input").val("")}),$("#logout").on("click",function(){localStorage.clear(),$("#register").show(),$("#login").show(),$("#logout").hide(),$("#create-post").hide(),_notifier2.default.send("You logged out")})})}();