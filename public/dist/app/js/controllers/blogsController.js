"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var a=[],r=!0,l=!1,o=void 0;try{for(var n,s=e[Symbol.iterator]();!(r=(n=s.next()).done)&&(a.push(n.value),!t||a.length!==t);r=!0);}catch(e){l=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(l)throw o}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_templates=require("../../../helpers/templates.js"),_templates2=_interopRequireDefault(_templates),_notifier=require("../../../helpers/notifier.js"),_notifier2=_interopRequireDefault(_notifier),_blogsData=require("../data/blogs-data.js"),_blogsData2=_interopRequireDefault(_blogsData);exports.default={home:function(e){var t=e.params.page,a=e.params.size;Promise.all([_blogsData2.default.all(t,a),_templates2.default.load("home")]).then(function(t){var a=_slicedToArray(t,2),r=a[0],l=a[1],o=JSON.parse(JSON.stringify(r.result.blogs)),n=JSON.parse(JSON.stringify(r.result.pagination));e.$element().html(l({blogs:o,pagination:n}))})},allByCategoryName:function(e){var t=e.params.subcategory,a=e.params.category;Promise.all([_blogsData2.default.byCategoryName(t,a),_templates2.default.load("list-blogs-category")]).then(function(t){var a=_slicedToArray(t,2),r=a[0],l=a[1];e.$element().html(l({blogs:r}))})},byId:function(e){var t=e.params.id;Promise.all([_blogsData2.default.byId(t),_templates2.default.load("single-blog")]).then(function(a){var r=_slicedToArray(a,2),l=r[0],o=r[1],n=localStorage.getItem("user"),s=JSON.parse(n);e.$element().html(o(l.blog)),$("#leave-reply-submit").on("click",function(e){e.preventDefault();var a={content:$("#leave-reply-text").val(),postedBy:s.username||"Stranger"};_blogsData2.default.addComment(t,a),location.reload(!0)})})},post:function(e){_templates2.default.load("blog-create").then(function(t){e.$element().html(t()),$("#btn-create-post").on("click",function(){var t,a=localStorage.getItem("user"),r=JSON.parse(a),l=$("#create-tags").val().split(" ").filter(function(e){return e}),o={title:$("#title").val(),category:$("#category").val(),subcategory:$("#subcategory").val(),image:$("#image").val(),article:$("#article").val(),tags:[],postedBy:r.username};(t=o.tags).push.apply(t,_toConsumableArray(l)),_blogsData2.default.create(o).then(function(){_notifier2.default.send("Post created!"),e.redirect("#/home")})})})},searchCategory:function(e){var t=e.params.category;Promise.all([_blogsData2.default.allCategoryName(t),_templates2.default.load("list-blogs-category")]).then(function(t){var a=_slicedToArray(t,2),r=a[0],l=a[1];console.log(r),e.$element().html(l({blogs:r}))})},searchSubCategory:function(e){var t=e.params.subcategory;Promise.all([_blogsData2.default.allSubcategoryName(t),_templates2.default.load("list-blogs-category")]).then(function(t){var a=_slicedToArray(t,2),r=a[0],l=a[1];console.log(r),e.$element().html(l({blogs:r}))})}};